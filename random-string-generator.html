<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Random String Generator</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        background: #f5f7fb;
        padding: 20px;
        color: #1f2937;
      }
      .container {
        max-width: 1000px;
        margin: 0 auto;
      }
      h1 {
        margin-bottom: 24px;
        color: #111827;
      }
      .section {
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      .section h2 {
        font-size: 18px;
        font-weight: 600;
        color: #111827;
        margin-bottom: 16px;
      }
      .controls-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
        margin-bottom: 20px;
      }
      .control-group {
        display: flex;
        flex-direction: column;
      }
      .control-group label {
        font-weight: 600;
        font-size: 14px;
        color: #6b7280;
        margin-bottom: 8px;
      }
      input[type="number"],
      input[type="text"] {
        padding: 10px 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 14px;
        width: 100%;
      }
      input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }
      .checkbox-group {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-bottom: 20px;
      }
      .checkbox-item {
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .checkbox-item input[type="checkbox"] {
        width: 18px;
        height: 18px;
        cursor: pointer;
      }
      .checkbox-item label {
        font-size: 14px;
        color: #6b7280;
        cursor: pointer;
        margin: 0;
      }
      .button-group {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        margin-bottom: 20px;
      }
      .btn {
        padding: 10px 20px;
        background: #3b82f6;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.2s;
      }
      .btn:hover {
        background: #2563eb;
      }
      .btn-secondary {
        background: #6b7280;
      }
      .btn-secondary:hover {
        background: #4b5563;
      }
      .btn-success {
        background: #059669;
      }
      .btn-success:hover {
        background: #047857;
      }
      .btn-small {
        padding: 6px 12px;
        font-size: 12px;
      }
      .output-section {
        margin-top: 20px;
      }
      .output-item {
        background: #f9fafb;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        padding: 12px;
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }
      .output-text {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
        font-size: 14px;
        color: #111827;
        flex: 1;
        word-break: break-all;
      }
      .output-actions {
        display: flex;
        gap: 8px;
      }
      .presets-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 12px;
        margin-top: 16px;
      }
      .preset-item {
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        padding: 12px;
        cursor: pointer;
        transition: all 0.2s;
      }
      .preset-item:hover {
        border-color: #3b82f6;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .preset-name {
        font-weight: 600;
        color: #111827;
        margin-bottom: 4px;
        font-size: 14px;
      }
      .preset-desc {
        font-size: 12px;
        color: #6b7280;
      }
      .error {
        color: #dc2626;
        background: #fef2f2;
        padding: 12px;
        border-radius: 6px;
        margin-bottom: 16px;
        font-size: 14px;
      }
      .info {
        color: #059669;
        background: #ecfdf5;
        padding: 12px;
        border-radius: 6px;
        margin-bottom: 16px;
        font-size: 14px;
      }
      .stats {
        display: flex;
        gap: 24px;
        padding: 12px;
        background: #f9fafb;
        border-radius: 6px;
        margin-bottom: 16px;
        font-size: 14px;
        flex-wrap: wrap;
      }
      .stat-item {
        display: flex;
        flex-direction: column;
      }
      .stat-label {
        color: #6b7280;
        font-size: 12px;
        margin-bottom: 4px;
      }
      .stat-value {
        font-weight: 600;
        color: #111827;
      }
      .custom-chars-group {
        margin-top: 12px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Random String Generator</h1>

      <div class="section">
        <h2>Options</h2>
        <div class="controls-grid">
          <div class="control-group">
            <label for="length">Length</label>
            <input type="number" id="length" value="16" min="1" max="10000" />
          </div>
          <div class="control-group">
            <label for="count">Number of Strings</label>
            <input type="number" id="count" value="1" min="1" max="100" />
          </div>
        </div>

        <div class="checkbox-group">
          <div class="checkbox-item">
            <input type="checkbox" id="include-uppercase" checked />
            <label for="include-uppercase">Include Uppercase (A-Z)</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="include-lowercase" checked />
            <label for="include-lowercase">Include Lowercase (a-z)</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="include-numbers" checked />
            <label for="include-numbers">Include Numbers (0-9)</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="include-symbols" />
            <label for="include-symbols">Include Symbols (!@#$%^&*)</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="exclude-similar" />
            <label for="exclude-similar"
              >Exclude Similar Characters (0, O, I, l, 1)</label
            >
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="exclude-ambiguous" />
            <label for="exclude-ambiguous"
              >Exclude Ambiguous Characters ({ } [ ] ( ) / \ ' " ` ~ , ; : . <
              >)</label
            >
          </div>
        </div>

        <div class="control-group custom-chars-group">
          <label for="custom-chars">Custom Characters (optional)</label>
          <input
            type="text"
            id="custom-chars"
            placeholder="Enter custom characters to include"
          />
          <div style="font-size: 12px; color: #6b7280; margin-top: 4px">
            These characters will be added to the character set
          </div>
        </div>

        <div class="button-group">
          <button class="btn" onclick="generateStrings()">Generate</button>
          <button class="btn btn-secondary" onclick="clearOutput()">
            Clear
          </button>
          <button class="btn btn-success" onclick="copyAll()">Copy All</button>
        </div>

        <div id="error-message"></div>
        <div id="info-message"></div>
      </div>

      <div class="section" id="output-section" style="display: none">
        <h2>Generated Strings</h2>
        <div class="stats" id="stats-container"></div>
        <div id="output-list"></div>
      </div>

      <div class="section">
        <h2>Presets</h2>
        <div class="presets-grid" id="presets-grid"></div>
      </div>
    </div>

    <script>
      const presets = [
        {
          name: "Password (Strong)",
          length: 16,
          uppercase: true,
          lowercase: true,
          numbers: true,
          symbols: true,
          excludeSimilar: true,
          excludeAmbiguous: false,
          description: "Strong password with all character types",
        },
        {
          name: "Password (Simple)",
          length: 12,
          uppercase: true,
          lowercase: true,
          numbers: true,
          symbols: false,
          excludeSimilar: true,
          excludeAmbiguous: false,
          description: "Simple password without symbols",
        },
        {
          name: "API Key",
          length: 32,
          uppercase: true,
          lowercase: true,
          numbers: true,
          symbols: false,
          excludeSimilar: true,
          excludeAmbiguous: false,
          description: "API key format",
        },
        {
          name: "Token",
          length: 64,
          uppercase: true,
          lowercase: true,
          numbers: true,
          symbols: false,
          excludeSimilar: false,
          excludeAmbiguous: false,
          description: "Long token string",
        },
        {
          name: "UUID-like",
          length: 36,
          uppercase: true,
          lowercase: true,
          numbers: true,
          symbols: false,
          excludeSimilar: false,
          excludeAmbiguous: false,
          description: "UUID format (with dashes)",
        },
        {
          name: "Numeric Only",
          length: 8,
          uppercase: false,
          lowercase: false,
          numbers: true,
          symbols: false,
          excludeSimilar: false,
          excludeAmbiguous: false,
          description: "Numbers only",
        },
        {
          name: "Alphanumeric",
          length: 16,
          uppercase: true,
          lowercase: true,
          numbers: true,
          symbols: false,
          excludeSimilar: false,
          excludeAmbiguous: false,
          description: "Letters and numbers",
        },
        {
          name: "Letters Only",
          length: 12,
          uppercase: true,
          lowercase: true,
          numbers: false,
          symbols: false,
          excludeSimilar: false,
          excludeAmbiguous: false,
          description: "Letters only",
        },
      ];

      function getCharacterSet() {
        let charset = "";

        if (document.getElementById("include-uppercase").checked) {
          charset += "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        }
        if (document.getElementById("include-lowercase").checked) {
          charset += "abcdefghijklmnopqrstuvwxyz";
        }
        if (document.getElementById("include-numbers").checked) {
          charset += "0123456789";
        }
        if (document.getElementById("include-symbols").checked) {
          charset += "!@#$%^&*()_+-=[]{}|;:,.<>?";
        }

        const customChars = document.getElementById("custom-chars").value;
        if (customChars) {
          charset += customChars;
        }

        // Remove duplicates
        charset = [...new Set(charset.split(""))].join("");

        // Exclude similar characters
        if (document.getElementById("exclude-similar").checked) {
          charset = charset.replace(/[0OIl1]/g, "");
        }

        // Exclude ambiguous characters
        if (document.getElementById("exclude-ambiguous").checked) {
          charset = charset.replace(/[{}[\]()/\\'"`~,;:.<>]/g, "");
        }

        return charset;
      }

      function generateRandomString(length, charset) {
        let result = "";
        const charsetLength = charset.length;

        if (charsetLength === 0) {
          throw new Error(
            "No character set available. Please select at least one character type."
          );
        }

        // Use crypto.getRandomValues for better randomness
        const array = new Uint32Array(length);
        crypto.getRandomValues(array);

        for (let i = 0; i < length; i++) {
          result += charset[array[i] % charsetLength];
        }

        return result;
      }

      function generateStrings() {
        const length = parseInt(document.getElementById("length").value) || 16;
        const count = parseInt(document.getElementById("count").value) || 1;
        const errorDiv = document.getElementById("error-message");
        const outputSection = document.getElementById("output-section");
        const outputList = document.getElementById("output-list");
        const statsContainer = document.getElementById("stats-container");

        errorDiv.innerHTML = "";

        if (length < 1 || length > 10000) {
          errorDiv.innerHTML =
            '<div class="error">Length must be between 1 and 10000</div>';
          return;
        }

        if (count < 1 || count > 100) {
          errorDiv.innerHTML =
            '<div class="error">Count must be between 1 and 100</div>';
          return;
        }

        try {
          const charset = getCharacterSet();
          const strings = [];

          for (let i = 0; i < count; i++) {
            strings.push(generateRandomString(length, charset));
          }

          // Display results
          outputList.innerHTML = strings
            .map(
              (str, idx) => `
            <div class="output-item">
              <span class="output-text">${escapeHtml(str)}</span>
              <div class="output-actions">
                <button class="btn btn-small btn-secondary" onclick="copyString(${idx})">
                  Copy
                </button>
              </div>
            </div>
          `
            )
            .join("");

          // Store strings for copy functionality
          window.generatedStrings = strings;

          // Update stats
          const charsetSize = charset.length;
          const possibleCombinations = Math.pow(charsetSize, length);
          statsContainer.innerHTML = `
            <div class="stat-item">
              <div class="stat-label">Character Set Size</div>
              <div class="stat-value">${charsetSize} characters</div>
            </div>
            <div class="stat-item">
              <div class="stat-label">Possible Combinations</div>
              <div class="stat-value">${formatNumber(
                possibleCombinations
              )}</div>
            </div>
            <div class="stat-item">
              <div class="stat-label">Entropy (bits)</div>
              <div class="stat-value">${Math.log2(possibleCombinations).toFixed(
                2
              )}</div>
            </div>
          `;

          outputSection.style.display = "block";

          // Save to sessionStorage
          sessionStorage.setItem("rsg_length", length);
          sessionStorage.setItem("rsg_count", count);
          sessionStorage.setItem(
            "rsg_uppercase",
            document.getElementById("include-uppercase").checked
          );
          sessionStorage.setItem(
            "rsg_lowercase",
            document.getElementById("include-lowercase").checked
          );
          sessionStorage.setItem(
            "rsg_numbers",
            document.getElementById("include-numbers").checked
          );
          sessionStorage.setItem(
            "rsg_symbols",
            document.getElementById("include-symbols").checked
          );
          sessionStorage.setItem(
            "rsg_exclude_similar",
            document.getElementById("exclude-similar").checked
          );
          sessionStorage.setItem(
            "rsg_exclude_ambiguous",
            document.getElementById("exclude-ambiguous").checked
          );
          sessionStorage.setItem(
            "rsg_custom_chars",
            document.getElementById("custom-chars").value
          );
        } catch (error) {
          errorDiv.innerHTML = `<div class="error">${error.message}</div>`;
          outputSection.style.display = "none";
        }
      }

      function copyString(index) {
        if (window.generatedStrings && window.generatedStrings[index]) {
          navigator.clipboard
            .writeText(window.generatedStrings[index])
            .then(() => {
              showInfo("String copied to clipboard!");
            });
        }
      }

      function copyAll() {
        if (window.generatedStrings && window.generatedStrings.length > 0) {
          const allStrings = window.generatedStrings.join("\n");
          navigator.clipboard.writeText(allStrings).then(() => {
            showInfo("All strings copied to clipboard!");
          });
        }
      }

      function clearOutput() {
        document.getElementById("output-list").innerHTML = "";
        document.getElementById("output-section").style.display = "none";
        window.generatedStrings = [];
      }

      function loadPreset(preset) {
        document.getElementById("length").value = preset.length;
        document.getElementById("include-uppercase").checked = preset.uppercase;
        document.getElementById("include-lowercase").checked = preset.lowercase;
        document.getElementById("include-numbers").checked = preset.numbers;
        document.getElementById("include-symbols").checked = preset.symbols;
        document.getElementById("exclude-similar").checked =
          preset.excludeSimilar;
        document.getElementById("exclude-ambiguous").checked =
          preset.excludeAmbiguous;
        generateStrings();
      }

      function escapeHtml(text) {
        const div = document.createElement("div");
        div.textContent = text;
        return div.innerHTML;
      }

      function formatNumber(num) {
        if (num >= 1e15) return (num / 1e15).toFixed(2) + "Q";
        if (num >= 1e12) return (num / 1e12).toFixed(2) + "T";
        if (num >= 1e9) return (num / 1e9).toFixed(2) + "B";
        if (num >= 1e6) return (num / 1e6).toFixed(2) + "M";
        if (num >= 1e3) return (num / 1e3).toFixed(2) + "K";
        return num.toString();
      }

      function showInfo(message) {
        const infoDiv = document.getElementById("info-message");
        infoDiv.innerHTML = `<div class="info">${message}</div>`;
        setTimeout(() => {
          infoDiv.innerHTML = "";
        }, 3000);
      }

      function initPresets() {
        const grid = document.getElementById("presets-grid");
        grid.innerHTML = presets
          .map(
            (preset, index) => `
          <div class="preset-item" data-preset-index="${index}">
            <div class="preset-name">${preset.name}</div>
            <div class="preset-desc">${preset.description}</div>
          </div>
        `
          )
          .join("");

        // Add event listeners
        grid.querySelectorAll(".preset-item").forEach((item) => {
          item.addEventListener("click", () => {
            const index = parseInt(item.getAttribute("data-preset-index"));
            loadPreset(presets[index]);
          });
        });
      }

      // Load from sessionStorage on page load
      window.addEventListener("DOMContentLoaded", () => {
        const savedLength = sessionStorage.getItem("rsg_length");
        const savedCount = sessionStorage.getItem("rsg_count");
        const savedUppercase = sessionStorage.getItem("rsg_uppercase");
        const savedLowercase = sessionStorage.getItem("rsg_lowercase");
        const savedNumbers = sessionStorage.getItem("rsg_numbers");
        const savedSymbols = sessionStorage.getItem("rsg_symbols");
        const savedExcludeSimilar = sessionStorage.getItem(
          "rsg_exclude_similar"
        );
        const savedExcludeAmbiguous = sessionStorage.getItem(
          "rsg_exclude_ambiguous"
        );
        const savedCustomChars = sessionStorage.getItem("rsg_custom_chars");

        if (savedLength) document.getElementById("length").value = savedLength;
        if (savedCount) document.getElementById("count").value = savedCount;
        if (savedUppercase !== null)
          document.getElementById("include-uppercase").checked =
            savedUppercase === "true";
        if (savedLowercase !== null)
          document.getElementById("include-lowercase").checked =
            savedLowercase === "true";
        if (savedNumbers !== null)
          document.getElementById("include-numbers").checked =
            savedNumbers === "true";
        if (savedSymbols !== null)
          document.getElementById("include-symbols").checked =
            savedSymbols === "true";
        if (savedExcludeSimilar !== null)
          document.getElementById("exclude-similar").checked =
            savedExcludeSimilar === "true";
        if (savedExcludeAmbiguous !== null)
          document.getElementById("exclude-ambiguous").checked =
            savedExcludeAmbiguous === "true";
        if (savedCustomChars)
          document.getElementById("custom-chars").value = savedCustomChars;

        initPresets();
      });
    </script>
  </body>
</html>
